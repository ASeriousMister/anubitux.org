<!DOCTYPE html><html lang="en-gb"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Capture and review network traffic with AnuBitux - anubitux.org</title><meta name="description" content="Wireshark is a very powerful tool to analyze network traffic. Let's see a few examples about how to use it to see what information is leaving our device."><meta name="generator" content="Publii Open-Source CMS for Static Site"><link rel="canonical" href="https://anubitux.org/capture-and-review-network-traffic-with-anubitux/"><link rel="alternate" type="application/atom+xml" href="https://anubitux.org/feed.xml"><link rel="alternate" type="application/json" href="https://anubitux.org/feed.json"><meta property="og:title" content="Capture and review network traffic with AnuBitux"><meta property="og:image" content="https://anubitux.org/media/posts/15/fractal-g413a8f627_1920.jpg"><meta property="og:image:width" content="1920"><meta property="og:image:height" content="876"><meta property="og:site_name" content="anubitux.org"><meta property="og:description" content="Wireshark is a very powerful tool to analyze network traffic. Let's see a few examples about how to use it to see what information is leaving our device."><meta property="og:url" content="https://anubitux.org/capture-and-review-network-traffic-with-anubitux/"><meta property="og:type" content="article"><link rel="shortcut icon" href="https://anubitux.org/media/website/AnubituxLogo2s-2.png" type="image/x-icon"><link rel="stylesheet" href="https://anubitux.org/assets/css/style.css?v=a1f2254669d0be271e31c4ba204e7483"><script type="application/ld+json">{"@context":"http://schema.org","@type":"Article","mainEntityOfPage":{"@type":"WebPage","@id":"https://anubitux.org/capture-and-review-network-traffic-with-anubitux/"},"headline":"Capture and review network traffic with AnuBitux","datePublished":"2023-02-05T10:30","dateModified":"2023-06-10T11:09","image":{"@type":"ImageObject","url":"https://anubitux.org/media/posts/15/fractal-g413a8f627_1920.jpg","height":876,"width":1920},"description":"Wireshark is a very powerful tool to analyze network traffic. Let's see a few examples about how to use it to see what information is leaving our device.","author":{"@type":"Person","name":"Anu₿itux","url":"https://anubitux.org/authors/anubitux/"},"publisher":{"@type":"Organization","name":"Anu₿itux","logo":{"@type":"ImageObject","url":"https://anubitux.org/media/website/AnubituxLogo2_nobg2.png","height":720,"width":720}}}</script></head><body><div class="site-container"><header class="top" id="js-header"><a class="logo" href="https://anubitux.org/"><img src="https://anubitux.org/media/website/AnubituxLogo2_nobg2.png" alt="anubitux.org" width="720" height="720"></a><nav class="navbar js-navbar"><button class="navbar__toggle js-toggle" aria-label="Menu" aria-haspopup="true" aria-expanded="false"><span class="navbar__toggle-box"><span class="navbar__toggle-inner">Menu</span></span></button><ul class="navbar__menu"><li><a href="https://anubitux.org/" target="_self">Home</a></li><li><a href="https://anubitux.org/download-anubitux/" target="_self">Download</a></li><li><a href="https://anubitux.org/tutorials-and-howtos/" target="_self">Tutorials &amp; Docs</a></li><li><a href="https://anubitux.org/faq/" target="_self">F.A.Q.</a></li><li><a href="https://anubitux.org/meet-the-anubitux-project/" target="_self">Credits</a></li></ul></nav></header><main><article class="post"><div class="hero"><figure class="hero__image hero__image--overlay"><img src="https://anubitux.org/media/posts/15/fractal-g413a8f627_1920.jpg" srcset="https://anubitux.org/media/posts/15/responsive/fractal-g413a8f627_1920-xs.jpg 300w, https://anubitux.org/media/posts/15/responsive/fractal-g413a8f627_1920-sm.jpg 480w, https://anubitux.org/media/posts/15/responsive/fractal-g413a8f627_1920-md.jpg 768w, https://anubitux.org/media/posts/15/responsive/fractal-g413a8f627_1920-lg.jpg 1024w, https://anubitux.org/media/posts/15/responsive/fractal-g413a8f627_1920-xl.jpg 1360w, https://anubitux.org/media/posts/15/responsive/fractal-g413a8f627_1920-2xl.jpg 1600w" sizes="(max-width: 1600px) 100vw, 1600px" loading="eager" height="876" width="1920" alt=""></figure><header class="hero__content"><div class="wrapper"><div class="post__meta"><time datetime="2023-02-05T10:30">5 Feb 2023</time></div><h1>Capture and review network traffic with AnuBitux</h1><div class="post__meta post__meta--author"><img src="https://anubitux.org/media/website/AnubituxLogo2s-3.png" loading="eager" height="720" width="720" class="post__author-thumb" alt="Anu₿itux"> <a href="https://anubitux.org/authors/anubitux/" class="feed__author">Anu₿itux</a></div></div></header></div><div class="wrapper post__entry"><p>When handling our cryptocurrencies, we feel more comfortable being offline but, sometimes, we can't perform operations without using an internet connection. In these cases, we are always afraid that some sensible information could be leaked. With AnuBitux we have a lot of countermeasures, like a <a href="https://anubitux.org/enable-network-monitor-in-anubitux-2/" target="_blank" rel="noopener noreferrer">network monitor</a> on the lower right side of our screen and a desktop shortcut that disables all the communication features. If we want to perform some additional checks, even to verify if AnuBitux is working properly, we can use <a href="https://www.wireshark.org/" target="_blank" rel="noopener noreferrer">Wireshark</a>, a tool that captures all the incoming and outgoing network traffic and allows us to review it with a lot of powerful features like filters and streams reconstruction.</p><h3>First steps</h3><p>We can find wireshark in the Useful Tools menu. If we want to run it with root privileges, we can launch it from our terminal typing</p><p class="align-center"><code>sudo wireshark</code></p><p>Remember that in AnuBitux the default root password is set to anubitux.</p><p>Now we can choose which network interface we want packets to be captured and start the acquisition by clicking on the shark's fin button.</p><figure class="post__image post__image--center"><img loading="lazy" src="https://anubitux.org/media/posts/15/Selection_161.png" alt="" width="740" height="575" sizes="100vw" srcset="https://anubitux.org/media/posts/15/responsive/Selection_161-xs.png 300w, https://anubitux.org/media/posts/15/responsive/Selection_161-sm.png 480w, https://anubitux.org/media/posts/15/responsive/Selection_161-md.png 768w, https://anubitux.org/media/posts/15/responsive/Selection_161-lg.png 1024w, https://anubitux.org/media/posts/15/responsive/Selection_161-xl.png 1360w, https://anubitux.org/media/posts/15/responsive/Selection_161-2xl.png 1600w"></figure><h3>Decrypting encrypted network traffic</h3><p>Nowadays most of the network traffic is encrypted with TLS, so even if we capture it, we won't be able to read it. To see what's flowing through our Internet connection, we need to configure a <a href="https://crypto.stackexchange.com/questions/27131/differences-between-the-terms-pre-master-secret-master-secret-private-key" target="_blank" rel="noopener noreferrer">pre-master secret key</a>.</p><p>To prepare it, we need to set up an environment variable, setting up a file that stores handshakes and that can be used by Wireshark to decrypt network traffic.</p><p>Let's create an empty text file, for instance in our Documents folder and name it keylogfile.txt. Now we need to edit the SSLKEYLOGFILE environment variable so that the information we need will be stored in this file. We can do that by opening our terminal and typing </p><p class="align-center"><code>nano .bashrc</code></p><p>and adding this line at the end of the file</p><p class="align-center"><code>export SSLKEYLOGFILE=/home/anubitux/Documents/keylogfile.txt</code></p><p>Then we can close the nano text editor pressing Ctrl+X and saving the modified file (without renaming it).</p><p>Now we need to restart our Terminal so that it takes effect. To check if it worked, we can type</p><p class="align-center"><code>echo $SSLKEYLOGFILE</code></p><figure class="post__image post__image--center"><img loading="lazy" src="https://anubitux.org/media/posts/15/Selection_162.png" alt="" width="390" height="66" sizes="100vw" srcset="https://anubitux.org/media/posts/15/responsive/Selection_162-xs.png 300w, https://anubitux.org/media/posts/15/responsive/Selection_162-sm.png 480w, https://anubitux.org/media/posts/15/responsive/Selection_162-md.png 768w, https://anubitux.org/media/posts/15/responsive/Selection_162-lg.png 1024w, https://anubitux.org/media/posts/15/responsive/Selection_162-xl.png 1360w, https://anubitux.org/media/posts/15/responsive/Selection_162-2xl.png 1600w"></figure><p>At this point we have to set up Wireshark to use the content of this file to decrypt the captured network traffic. To do that we have to open Wireshark, go to Edit and click on Preferences, then under the protocols list select TLS and, clicking on the Browse button, provide the keylogfile we created.</p><figure class="post__image post__image--center"><img loading="lazy" src="https://anubitux.org/media/posts/15/Selection_163.png" alt="" width="740" height="578" sizes="100vw" srcset="https://anubitux.org/media/posts/15/responsive/Selection_163-xs.png 300w, https://anubitux.org/media/posts/15/responsive/Selection_163-sm.png 480w, https://anubitux.org/media/posts/15/responsive/Selection_163-md.png 768w, https://anubitux.org/media/posts/15/responsive/Selection_163-lg.png 1024w, https://anubitux.org/media/posts/15/responsive/Selection_163-xl.png 1360w, https://anubitux.org/media/posts/15/responsive/Selection_163-2xl.png 1600w"></figure><p>Now Wireshark will be able to decrypt network traffic and show it in plain text.</p><h3>Capturing traffic</h3><p>Finally, we can start capturing our traffic by clicking on the shark's fin button. To see something going on, let's start the Firefox browser (it may be necessary to start it from the Terminal, to make sure it stores keys in the keylogfile.txt file).</p><p>Then we can visit some websites that use HTTPS, like anubitux.org and iancoleman.io. After browsing some pages we can stop the network capture and review it.</p><p>In the below picture, we can see an example with a captured TLS packet.</p><figure class="post__image post__image--center"><img loading="lazy" src="https://anubitux.org/media/posts/15/Selection_164.png" alt="" width="930" height="826" sizes="100vw" srcset="https://anubitux.org/media/posts/15/responsive/Selection_164-xs.png 300w, https://anubitux.org/media/posts/15/responsive/Selection_164-sm.png 480w, https://anubitux.org/media/posts/15/responsive/Selection_164-md.png 768w, https://anubitux.org/media/posts/15/responsive/Selection_164-lg.png 1024w, https://anubitux.org/media/posts/15/responsive/Selection_164-xl.png 1360w, https://anubitux.org/media/posts/15/responsive/Selection_164-2xl.png 1600w"></figure><p>To see its content we need to click on the proper button in the lower part of the user interface. These buttons would not be available without setting up the key log file as we did before.</p><p>In this case, it is a packet related to the HTTPS certificate verification process. With most of the websites, even if packets are unencrypted, we won't see the plain text because the information are sent in gzip format. Sometimes Wireshark will be able to see it, providing us another button to see the uncompressed content of packets.</p><figure class="post__image post__image--center"><img loading="lazy" src="https://anubitux.org/media/posts/15/Selection_165.png" alt="" width="570" height="71" sizes="100vw" srcset="https://anubitux.org/media/posts/15/responsive/Selection_165-xs.png 300w, https://anubitux.org/media/posts/15/responsive/Selection_165-sm.png 480w, https://anubitux.org/media/posts/15/responsive/Selection_165-md.png 768w, https://anubitux.org/media/posts/15/responsive/Selection_165-lg.png 1024w, https://anubitux.org/media/posts/15/responsive/Selection_165-xl.png 1360w, https://anubitux.org/media/posts/15/responsive/Selection_165-2xl.png 1600w"></figure><p>If we are interested in packets we exchanged with a specific website, like iancoleman.io, we can filter our list knowing its IP address. To check it out we can ping it, as seen above.</p><figure class="post__image post__image--center"><img loading="lazy" src="https://anubitux.org/media/posts/15/Selection_166.png" alt="" width="730" height="261" sizes="100vw" srcset="https://anubitux.org/media/posts/15/responsive/Selection_166-xs.png 300w, https://anubitux.org/media/posts/15/responsive/Selection_166-sm.png 480w, https://anubitux.org/media/posts/15/responsive/Selection_166-md.png 768w, https://anubitux.org/media/posts/15/responsive/Selection_166-lg.png 1024w, https://anubitux.org/media/posts/15/responsive/Selection_166-xl.png 1360w, https://anubitux.org/media/posts/15/responsive/Selection_166-2xl.png 1600w"></figure><p>Now we can set up filters in the proper box, based on the IP address we have found. To see both incoming and outgoing traffic the syntax is</p><p class="align-center"><code>ip.src == 99.86.159.30 or ip.dst == 99.86.159.30</code></p><figure class="post__image post__image--center"><img loading="lazy" src="https://anubitux.org/media/posts/15/Selection_167.png" alt="" width="910" height="827" sizes="100vw" srcset="https://anubitux.org/media/posts/15/responsive/Selection_167-xs.png 300w, https://anubitux.org/media/posts/15/responsive/Selection_167-sm.png 480w, https://anubitux.org/media/posts/15/responsive/Selection_167-md.png 768w, https://anubitux.org/media/posts/15/responsive/Selection_167-lg.png 1024w, https://anubitux.org/media/posts/15/responsive/Selection_167-xl.png 1360w, https://anubitux.org/media/posts/15/responsive/Selection_167-2xl.png 1600w"></figure><p>In the picture we can see a packet we have sent to iancoleman.io's website with the details of our browser. It was an encrypted package and we can see its content only thanks to the setup we have made.</p><h3>Final thoughts</h3><p>Wireshark is a very powerful tool to analyze network traffic. In this post, we have seen only a few examples of how to use it but it can be applied in a lot of different situations, not only for analyzing network activity but also for penetration testing and security audits. It also requires very good skills to be used properly, since it collects thousands of packets every few seconds and most of them seem to be meaningless without knowing what is going on. There are a lot of guides and tutorials online about how to use it, even on the official <a href="https://www.wireshark.org/#learnWS" target="_blank" rel="noopener noreferrer">website</a>. </p><p> </p><p> </p><p> </p><p> </p><p> </p></div><footer class="wrapper post__footer"><p class="post__last-updated">This article was updated on 10 Jun 2023</p></footer></article><nav class="post__nav"><div class="post__nav-inner"><div class="post__nav-prev"><svg width="1.041em" height="0.416em" aria-hidden="true"><use xlink:href="https://anubitux.org/assets/svg/svg-map.svg#arrow-prev"/></svg> <a href="https://anubitux.org/from-wax-tablets-to-elliptical-curves-a-brief-history-of-cryptography-part-two/" class="post__nav-link" rel="prev"><span>Previous</span> From wax tablets to elliptical curves. A Brief History of Cryptography (Part Two)</a></div><div class="post__nav-next"><a href="https://anubitux.org/find-the-last-word-of-your-mnemonic-with-anubitux/" class="post__nav-link" rel="next"><span>Next</span> Find the last word for your mnemonic with AnuBitux </a><svg width="1.041em" height="0.416em" aria-hidden="true"><use xlink:href="https://anubitux.org/assets/svg/svg-map.svg#arrow-next"/></svg></div></div></nav><div class="post__related related"><div class="wrapper"><h2 class="h5 related__title">You should also read:</h2><article class="related__item"><div class="feed__meta"><time datetime="2022-07-01T19:18" class="feed__date">1 Jul 2022</time></div><h3 class="h1"><a href="https://anubitux.org/enable-network-monitor-in-anubitux/">Enable network monitor in AnuBitux</a></h3></article><article class="related__item"><div class="feed__meta"><time datetime="2022-07-01T19:02" class="feed__date">1 Jul 2022</time></div><h3 class="h1"><a href="https://anubitux.org/how-to-create-a-paper-wallet-with-anubitux/">How to create a paper wallet with AnuBitux</a></h3></article><article class="related__item"><div class="feed__meta"><time datetime="2022-06-30T12:22" class="feed__date">30 Jun 2022</time></div><h3 class="h1"><a href="https://anubitux.org/how-to-use-anubitux/">How to use AnuBitux</a></h3></article></div></div></main><footer class="footer"><div class="footer__copyright"><p><em>Powered by Publii - website's source available on <a href="https://github.com/ASeriousMister/anubitux.org" target="_blank" rel="noopener">github</a></em></p><p><em>Follow us: <span style="color: #236fa1;"><a href="https://t.me/anubitux" target="_blank" rel="noopener" style="color: #236fa1;">Telegram</a></span> - <a href="https://twitter.com/anubitux" target="_blank" rel="noopener"><span style="color: #c2e0f4;">Twitter</span></a></em></p><p><a href="https://anubitux.org"><em><span style="color: #c2e0f4;">HOME</span></em></a></p></div><button onclick="backToTopFunction()" id="backToTop" class="footer__bttop" aria-label="Back to top" title="Back to top"><svg><use xlink:href="https://anubitux.org/assets/svg/svg-map.svg#toparrow"/></svg></button></footer></div><script defer="defer" src="https://anubitux.org/assets/js/scripts.min.js?v=f47c11534595205f20935f0db2a62a85"></script><script>window.publiiThemeMenuConfig={mobileMenuMode:'sidebar',animationSpeed:300,submenuWidth: 'auto',doubleClickTime:500,mobileMenuExpandableSubmenus:true,relatedContainerForOverlayMenuSelector:'.top'};</script><script>var images = document.querySelectorAll('img[loading]');

        for (var i = 0; i < images.length; i++) {
            if (images[i].complete) {
                images[i].classList.add('is-loaded');
            } else {
                images[i].addEventListener('load', function () {
                    this.classList.add('is-loaded');
                }, false);
            }
        }</script></body></html>