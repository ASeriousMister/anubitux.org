<!DOCTYPE html><html lang="en-us"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Clustering bitcoin addresses</title><meta name="description" content="Know how to cluster bitcoin addresses could be important as for people who care about their privacy, as for people trying to discover information."><meta name="generator" content="Publii Open-Source CMS for Static Site"><link rel="canonical" href="https://anubitux.org/clustering-bitcoin-addresses/"><link rel="alternate" type="application/atom+xml" href="https://anubitux.org/feed.xml" title="anubitux.org - RSS"><link rel="alternate" type="application/json" href="https://anubitux.org/feed.json" title="anubitux.org - JSON"><meta property="og:title" content="Clustering Bitcoin addresses"><meta property="og:image" content="https://anubitux.org/media/posts/27/universe-g9bc0cc67d_1280.jpg"><meta property="og:image:width" content="1280"><meta property="og:image:height" content="488"><meta property="og:site_name" content="anubitux.org"><meta property="og:description" content="Know how to cluster bitcoin addresses could be important as for people who care about their privacy, as for people trying to discover information."><meta property="og:url" content="https://anubitux.org/clustering-bitcoin-addresses/"><meta property="og:type" content="article"><link rel="shortcut icon" href="https://anubitux.org/media/website/favicon-2.png" type="image/png"><link rel="preload" href="https://anubitux.org/assets/dynamic/fonts/jetbrainsmono/jetbrainsmono.woff2" as="font" type="font/woff2" crossorigin><link rel="preload" href="https://anubitux.org/assets/dynamic/fonts/jetbrainsmono/jetbrainsmono-italic.woff2" as="font" type="font/woff2" crossorigin><link rel="stylesheet" href="https://anubitux.org/assets/css/style.css?v=0de5ed4b6a37ab1ddecf11b6f3d8bbb5"><script type="application/ld+json">{"@context":"http://schema.org","@type":"Article","mainEntityOfPage":{"@type":"WebPage","@id":"https://anubitux.org/clustering-bitcoin-addresses/"},"headline":"Clustering Bitcoin addresses","datePublished":"2022-08-06T10:58+02:00","dateModified":"2024-05-15T16:41+02:00","image":{"@type":"ImageObject","url":"https://anubitux.org/media/posts/27/universe-g9bc0cc67d_1280.jpg","height":488,"width":1280},"description":"Know how to cluster bitcoin addresses could be important as for people who care about their privacy, as for people trying to discover information.","author":{"@type":"Person","name":"AnuBitux","url":"https://anubitux.org/authors/anubitux/"},"publisher":{"@type":"Organization","name":"AnuBitux","logo":{"@type":"ImageObject","url":"https://anubitux.org/media/website/AnubituxLogo2_nobg2.png","height":720,"width":720}}}</script><noscript><style>img[loading] {
                    opacity: 1;
                }</style></noscript><style>.extlink::after {
				background-color: currentColor;
				content: "";
				display: inline-block;
				height: 16px;
				margin-left: 5px;
				position: relative;
				top: 0px;
				width: 16px;
			}
		
					.extlink.extlink-icon-7::after {
						mask-image: url("data:image/svg+xml;utf8,<svg viewBox='0 0 24 24' fill='none' stroke='%23000000' stroke-width='2' stroke-linecap='round' stroke-linejoin='round' xmlns='http://www.w3.org/2000/svg'><path stroke='none' d='M0 0h24v24H0z' fill='none'/><path d='M3 12a9 9 0 1 0 18 0a9 9 0 0 0 -18 0' /><path d='M15 9l-6 6' /><path d='M15 15v-6h-6' /></svg>");
						mask-repeat: no-repeat;
						mask-size: contain;
					}</style></head><body class="post-template"><div class="container container--center"><header class="header"><div class="header__logo"><a class="logo" href="https://anubitux.org/"><img src="https://anubitux.org/media/website/AnubituxLogo2_nobg2.png" alt="anubitux.org" width="720" height="720"></a></div><nav class="navbar js-navbar"><button class="navbar__toggle js-toggle" aria-label="Menu" aria-haspopup="true" aria-expanded="false"><span class="navbar__toggle-box"><span class="navbar__toggle-inner">Menu</span></span></button><ul class="navbar__menu"><li><a href="https://anubitux.org/" target="_self">Home</a></li><li><a href="https://anubitux.org/download-anubitux/" target="_self">Download</a></li><li><a href="https://anubitux-project.gitbook.io/the-anubitux-documentation" target="_blank">Documentation</a></li><li><a href="https://anubitux.org/tutorials-and-howtos/" target="_self">Tutorials</a></li><li><a href="https://anubitux.org/faq/" target="_self">F.A.Q.</a></li><li><a href="https://anubitux.org/meet-the-anubitux-project/" target="_self">Credits</a></li><li><a href="https://github.com/AnuBitux-project/build" target="_blank">Source code</a></li></ul></nav></header><main class="content"><article class="post"><header><h1 class="post__title">Clustering Bitcoin addresses</h1><div class="post__meta"><time datetime="2022-08-06T10:58" class="post__date">August 6, 2022 </time><span class="post__author"><a href="https://anubitux.org/authors/anubitux/" class="feed__author">AnuBitux</a></span></div></header><figure class="post__image post__cover"><img src="https://anubitux.org/media/posts/27/universe-g9bc0cc67d_1280.jpg" srcset="https://anubitux.org/media/posts/27/responsive/universe-g9bc0cc67d_1280-xs.jpg 300w, https://anubitux.org/media/posts/27/responsive/universe-g9bc0cc67d_1280-sm.jpg 480w, https://anubitux.org/media/posts/27/responsive/universe-g9bc0cc67d_1280-md.jpg 768w, https://anubitux.org/media/posts/27/responsive/universe-g9bc0cc67d_1280-lg.jpg 1024w" sizes="(min-width: 920px) 703px, (min-width: 700px) calc(82vw - 35px), calc(100vw - 81px)" loading="eager" height="488" width="1280" alt=""><figcaption>https://pixabay.com/illustrations/universe-space-astronautics-703522/</figcaption></figure><div class="post__entry"><p>Using Bitcoin, it is important for both those who value their privacy and those who seek to collect information disseminated in the blockchain to know what clustering is and how it works.</p><h3>Basic knowledge</h3><p>Clustering addresses means assuming that they belong to the same owner which could be a person, a firm, a service like an exchange, a darknet market, a payment processor, etc.</p><p>This can be done by knowing how a Bitcoin transaction works. It allows users that have a valid private key to sign transactions that forward any amount that was previously received to an arbitrary address. This implies that it is not possible to spend any desired amount of bitcoin, but only amounts derived summing previously received ones that have not been spent yet. Those amounts are named UTxOs (unspent transaction outputs).</p><p>This seems to be a limit of the Bitcoin protocol, but this apparent issue is quickly solved, allowing users to send bitcoins to more addresses with the same transaction. So, when a user specifies to his client the amount he wants to send, the client chooses enough UTxOs to reach this value, sending the desired amount to the specified recipient address and sending the remaining part to another address (which could be the same sending address or a new address). This last address is called the change address and the amount it receives is named change of the transaction.</p><h3>Let's see an example.</h3><p>Anubis received three transactions, one of 0.5 bitcoins, one of 0.9 bitcoins and one of 0.3 bitcoins. Now, Anubis wants to send 1 bitcoin to Ramses.</p><p>Anubis' wallet will choose UTxOs to reach the amount of 1 bitcoin (some clients spend every time the entire available amount).</p><p>In this case, we can assume that the wallet chooses the amount of 0.9 bitcoins and the amount of 0.3, reaching a sum of 1.2 bitcoins. So, the client is going to create a transaction that sends 1.1 bitcoins to Ramses' address and 0.1 (minus the transaction fees) to another address belonging to Anubis.</p><p>If the UTxOs used by Anubis' wallet were received by the same address, the transaction will show only one sending address. Unless so, we will see more sending addresses. To make the transaction valid, it needs to be signed with the private keys corresponding to all the sending addresses (all belonging to Anubis).</p><figure class="post__image post__image--center"><img loading="lazy" src="https://anubitux.org/media/posts/27/utxo.drawio-3.png" alt="utxo_change" width="800" height="362" sizes="(min-width: 920px) 703px, (min-width: 700px) calc(82vw - 35px), calc(100vw - 81px)" srcset="https://anubitux.org/media/posts/27/responsive/utxo.drawio-3-xs.png 300w, https://anubitux.org/media/posts/27/responsive/utxo.drawio-3-sm.png 480w, https://anubitux.org/media/posts/27/responsive/utxo.drawio-3-md.png 768w, https://anubitux.org/media/posts/27/responsive/utxo.drawio-3-lg.png 1024w"></figure><h3>Let's cluster!</h3><p>With these premises, we can find out some methods that can be used to cluster addresses together. Here there are some clustering techniques, with examples obtained using <a href="https://www.blockchain.com/explorer" target="_blank" class="extlink extlink-icon-7" rel="noopener noreferrer">blockchain.com</a>'s explorer.</p><h4>Co-spending</h4><p>As stated above, when a transaction shows more input addresses, it means that it has been signed by the private key related to each of the sending addresses. It is technically possible to partially sign a transaction and then let it sign by another person, but it is an absolutely rare circumstance. In this case, it is possible to assume that all the sending addresses belong to the same entity and can be clustered together.</p><figure class="post__image post__image--center"><img loading="lazy" src="https://anubitux.org/media/posts/27/Selection_004.png" alt="cospending" width="800" height="295" sizes="(min-width: 920px) 703px, (min-width: 700px) calc(82vw - 35px), calc(100vw - 81px)" srcset="https://anubitux.org/media/posts/27/responsive/Selection_004-xs.png 300w, https://anubitux.org/media/posts/27/responsive/Selection_004-sm.png 480w, https://anubitux.org/media/posts/27/responsive/Selection_004-md.png 768w, https://anubitux.org/media/posts/27/responsive/Selection_004-lg.png 1024w"></figure><p>Some methods and solutions could give us false results. For instance, there are <a href="https://en.bitcoin.it/wiki/CoinJoin" target="_blank" class="extlink extlink-icon-7" rel="noopener noreferrer">CoinJoin</a> transactions, related to softwares like <a href="https://samouraiwallet.com/" target="_blank" class="extlink extlink-icon-7" rel="noopener noreferrer">Samourai</a> and <a href="https://wasabiwallet.io/" target="_blank" class="extlink extlink-icon-7" rel="noopener noreferrer">Wasabi</a>, where there are a lot of different input addresses that can't be clustered together. The addresses used by these services are spending bitcoins of different users, and clustering them together could give us wrong information. This kind of transactions can easily be recognized because there are many addresses spending the same amount.</p><figure class="post__image post__image--center"><img loading="lazy" src="https://anubitux.org/media/posts/27/Selection_005.png" alt="coinjoin" width="800" height="180" sizes="(min-width: 920px) 703px, (min-width: 700px) calc(82vw - 35px), calc(100vw - 81px)" srcset="https://anubitux.org/media/posts/27/responsive/Selection_005-xs.png 300w, https://anubitux.org/media/posts/27/responsive/Selection_005-sm.png 480w, https://anubitux.org/media/posts/27/responsive/Selection_005-md.png 768w, https://anubitux.org/media/posts/27/responsive/Selection_005-lg.png 1024w"></figure><p>Other false results could be obtained with <a href="https://en.bitcoin.it/wiki/PayJoin" target="_blank" class="extlink extlink-icon-7" rel="noopener noreferrer">PayJoin</a> transactions, supported by softwares like the above-mentioned Samourai and Wasabi. In this case, the UTxOs of different users are joined together in the same transactions, making it very difficult to recognize any single flow of coins. This kind of transactions, unlike CoinJoin transactions, is almost impossible to recognize, because they do not have any distinctive feature.</p><figure class="post__image post__image--center"><a href="https://samouraiwallet.com/stowaway" target="_blank" rel="noopener noreferrer"><img loading="lazy" src="https://anubitux.org/media/posts/27/Selection_010.png" alt="" width="800" height="278" sizes="(min-width: 920px) 703px, (min-width: 700px) calc(82vw - 35px), calc(100vw - 81px)" srcset="https://anubitux.org/media/posts/27/responsive/Selection_010-xs.png 300w, https://anubitux.org/media/posts/27/responsive/Selection_010-sm.png 480w, https://anubitux.org/media/posts/27/responsive/Selection_010-md.png 768w, https://anubitux.org/media/posts/27/responsive/Selection_010-lg.png 1024w"></a></figure><p></p><h4>Change address</h4><p>Looking at how change addresses work lets us assume that not only the input addresses can be clustered together, but also the one receiving the change. The only problem could be how to find out which one is receiving the change and which one is the effective recipient address (the one that is receiving the bitcoins that the user wanted to transfer).</p><h5>Amounts</h5><p>First of all we, can look at the transferred amounts. Usually, if an address receives an amount with a very low number of decimal digits, it could be the effective recipient address because:</p><ul><li>humans do not like complex numbers;</li><li>it is very unlikely to send an amount with eight decimal digits that would give a change (minus the transaction fees) with only a few decimal digits.</li></ul><figure class="post__image post__image--center"><img loading="lazy" src="https://anubitux.org/media/posts/27/Selection_006.png" alt="" width="800" height="135" sizes="(min-width: 920px) 703px, (min-width: 700px) calc(82vw - 35px), calc(100vw - 81px)" srcset="https://anubitux.org/media/posts/27/responsive/Selection_006-xs.png 300w, https://anubitux.org/media/posts/27/responsive/Selection_006-sm.png 480w, https://anubitux.org/media/posts/27/responsive/Selection_006-md.png 768w, https://anubitux.org/media/posts/27/responsive/Selection_006-lg.png 1024w"></figure><p>Considering that some clients choose the UTxOs so that the amount involved in the transactions reaches the amount that the user wants to transfer, the amount that necessarily requires all the involved UTxOs should be the effective recipient address. In the example of Anubis and Ramses, Anubis' client wouldn't have involved both the UTxOs if he intended to send only 0.1 bitcoins, so the address receiving that amount is necessarily the change address.</p><figure class="post__image post__image--center"><img loading="lazy" src="https://anubitux.org/media/posts/27/Selection_007.png" alt="" width="800" height="144" sizes="(min-width: 920px) 703px, (min-width: 700px) calc(82vw - 35px), calc(100vw - 81px)" srcset="https://anubitux.org/media/posts/27/responsive/Selection_007-xs.png 300w, https://anubitux.org/media/posts/27/responsive/Selection_007-sm.png 480w, https://anubitux.org/media/posts/27/responsive/Selection_007-md.png 768w, https://anubitux.org/media/posts/27/responsive/Selection_007-lg.png 1024w"></figure><p>Also in the transaction shown in the picture, if the user wanted to send 0.000888 bitcoins, he wouldn't have needed to involve three UTxOs. This rule works pretty well but, nowadays, lots of clients have their optimization algorithms and do not allow users to make coin selection. In some cases, to avoid address reuse, preserve users' privacy or consolidate the amounts, they spend all the available UTxOs of each address that is involved in the transaction. </p><h5>Address types</h5><p>The majority of the Bitcoin wallets usually use addresses of the same type (for example Electrum supports different kinds of addresses only when creating a wallet <a href="https://anubitux.org/how-to-spend-a-paper-wallet-with-anubitux/" target="_blank" rel="noopener noreferrer">importing the private keys</a>). When a transaction is sent to two addresses of different types, the change address is mostly the one in the same format as the sending addresses.</p><figure class="post__image post__image--center"><img loading="lazy" src="https://anubitux.org/media/posts/27/Selection_008.png" alt="" width="800" height="130" sizes="(min-width: 920px) 703px, (min-width: 700px) calc(82vw - 35px), calc(100vw - 81px)" srcset="https://anubitux.org/media/posts/27/responsive/Selection_008-xs.png 300w, https://anubitux.org/media/posts/27/responsive/Selection_008-sm.png 480w, https://anubitux.org/media/posts/27/responsive/Selection_008-md.png 768w, https://anubitux.org/media/posts/27/responsive/Selection_008-lg.png 1024w"></figure><h4>Consolidation transactions</h4><p>There is another situation to consider. Some users do not like to have many UTxOs in many addresses or sometimes move funds to cold storages or new wallets. In this case, we'll have a transaction without any change address, because users are moving all of their funds. So all the addresses involved in the transactions (senders and receiver) can be reconducted to the same person. Indeed, it is very unlikely that a user has available different UTxOs whose total amount is exactly what he intended to send including the exact transaction fee.</p><figure class="post__image post__image--center"><img loading="lazy" src="https://anubitux.org/media/posts/27/Selection_009.png" alt="" width="800" height="179" sizes="(min-width: 920px) 703px, (min-width: 700px) calc(82vw - 35px), calc(100vw - 81px)" srcset="https://anubitux.org/media/posts/27/responsive/Selection_009-xs.png 300w, https://anubitux.org/media/posts/27/responsive/Selection_009-sm.png 480w, https://anubitux.org/media/posts/27/responsive/Selection_009-md.png 768w, https://anubitux.org/media/posts/27/responsive/Selection_009-lg.png 1024w"></figure><p>We have to be careful with this kind of assertion, because it could also happen that users decide to empty their wallet sending all their coins to an exchange, maybe to convert virtual currency into FIAT currency or to do some trades. So, clustering the recipient address with the sending ones would mean clustering the user's addresses with an address belonging to an exchange. So, we need to observe how the recipient address is being used before clustering it with the sending ones.</p><h3>Final thoughts</h3><p>The mentioned techniques are all based on statistics and the observation of a huge amount of data, so they can mostly be considered valid. Someone that knows very well how Bitcoin works could circumvent these clustering methods, but it is very hard to do it without doing any mistakes. In any case, these techniques work very well in a great part of the cases. We only need to remember that exceptions happen and we have to be ready to question these methods at any time.</p><figure class="post__image post__image--center"><a href="https://www.buymeacoffee.com/anubitux" target="_blank" rel="noopener noreferrer"><img loading="lazy" src="https://anubitux.org/media/posts/27/buybeer.png" alt="" width="256" height="171" sizes="(min-width: 920px) 703px, (min-width: 700px) calc(82vw - 35px), calc(100vw - 81px)" srcset="https://anubitux.org/media/posts/27/responsive/buybeer-xs.png 300w, https://anubitux.org/media/posts/27/responsive/buybeer-sm.png 480w, https://anubitux.org/media/posts/27/responsive/buybeer-md.png 768w, https://anubitux.org/media/posts/27/responsive/buybeer-lg.png 1024w"></a></figure><p></p><p> </p></div><footer class="wrapper post__footer"><p class="post__last-updated">This article was updated on May 15, 2024</p></footer><nav class="pagination"><div class="pagination__title"><span>Read other posts</span></div><div class="pagination__buttons"><a href="https://anubitux.org/connecting-your-hardware-wallet-to-anubitux/" class="btn previous" rel="prev" aria-label="[MISSING TRANSLATION]:  Connecting your hardware wallet to AnuBitux "><span class="btn__icon">←</span> <span class="btn__text">Connecting your hardware wallet to AnuBitux</span> </a><a href="https://anubitux.org/how-to-sign-a-transaction-offline-with-anubitux/" class="btn next" rel="next" aria-label="[MISSING TRANSLATION]:  How to sign a transaction offline with AnuBitux "><span class="btn__text">How to sign a transaction offline with AnuBitux</span> <span class="btn__icon">→</span></a></div></nav></article></main><footer class="footer"><div class="footer__inner"><div class="footer__copyright"><p class="align-center">Website's source is available on <a href="https://github.com/ASeriousMister/anubitux.org" target="_blank" rel="noopener">GitHub</a><br><br>Follow us: <span style="color: #236fa1;"><a href="https://t.me/anubitux" target="_blank" rel="noopener" style="color: #236fa1;">Telegram</a></span> - <span style="color: #3598db;"><a href="https://twitter.com/anubitux" target="_blank" rel="noopener" style="color: #3598db;">X</a></span> - <span style="color: #e03e2d;"><a href="https://www.youtube.com/@AnuBitux" target="_blank" rel="noopener" style="color: #e03e2d;">YouTube</a></span><br><br><a href="https://anubitux.org/">HOME</a></p></div></div></footer></div><script defer="defer" src="https://anubitux.org/assets/js/scripts.min.js?v=c2232aa7558e9517946129d2a1b8c770"></script><script>window.publiiThemeMenuConfig={mobileMenuMode:'sidebar',animationSpeed:300,submenuWidth: 'auto',doubleClickTime:500,mobileMenuExpandableSubmenus:true,relatedContainerForOverlayMenuSelector:'.top'};</script><script>var images = document.querySelectorAll('img[loading]');
        for (var i = 0; i < images.length; i++) {
            if (images[i].complete) {
                images[i].classList.add('is-loaded');
            } else {
                images[i].addEventListener('load', function () {
                    this.classList.add('is-loaded');
                }, false);
            }
        }</script><script>'use strict'; document.addEventListener('DOMContentLoaded', function() { var obfElements = document.querySelectorAll('.obfuscated-email'); obfElements.forEach(function(elem) { var dataType = elem.getAttribute('data-type'); var encodedEmail = elem.getAttribute('data-email'); var user = elem.getAttribute('data-user'); var domain = elem.getAttribute('data-domain'); var decodedEmail = ''; if (user && domain) { decodedEmail = user.split('').reverse().join('') + '@' + domain.split('').reverse().join(''); } else if (encodedEmail) { const parts = encodedEmail.split('@'); if (parts.length === 2) { decodedEmail = parts[0].split('').reverse().join('') + '@' + parts[1].split('').reverse().join(''); } else { decodedEmail = encodedEmail; } } if (dataType === 'mailto') { var originalText = elem.textContent.trim(); var a = document.createElement('a'); a.href = 'mailto:' + decodedEmail; if (elem.classList.length > 0) { a.className = elem.className; } if (originalText === '') { a.textContent = decodedEmail; } else { a.textContent = originalText; } elem.parentNode.replaceChild(a, elem); } else if (dataType === 'text') { var textNode = document.createTextNode(decodedEmail); elem.parentNode.replaceChild(textNode, elem); } }); });</script></body></html>